---
- name: Remove MariaDB
  become: true
  yum:
    name: mariadb-server
    state: absent

- name: Add MySQL repository
  become_user: root   
  yum:
    name: https://dev.mysql.com/get/mysql80-community-release-el7-11.noarch.rpm
    state: present
    
- name: Install MySQL Server
  become_user: root
  yum:
    name: mysql-community-server
    state: present
  vars:
    enablerepo: mysql80-community

- name: Install MySQL Development Files
  become_user: root
  yum:
    name: mysql-community-devel
    state: present
  vars:
    enablerepo: mysql80-community
  
- name: Start MySQL service
  become_user: root
  service:
    name: mysqld
    state: started
    enabled: yes


# # Install MySQL
# - name: Remove MariaDB
#   become_user: root
#   yum:
#     name: mariadb-server
#     state: absent

# # - name: Import MySQL GPG key
# #   become_user: root
# #   shell: rpm --import "https://repo.mysql.com/RPM-GPG-KEY-mysql-2022"
# #   args:
# #     creates: /var/lib/mysql/mysql80-community-release-el7-7.noarch.rpm

# - name: Download and install MySQL repository package
#   become_user: root
#   shell: rpm -Uvh "https://dev.mysql.com/get/mysql80-community-release-el7-7.noarch.rpm"
#   args:
#     creates: /etc/yum.repos.d/mysql-community.repo
      
# - name: Install mysql-devel
#   become_user: root
#   yum:
#     name: "{{ item }}"
#     state: present
#   with_items:
#       - mysql-server
#       - mysql-devel
#       - mysql-community-devel
#       - mysql-community-server